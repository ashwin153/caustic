module caustic.example

/**
 * A counter.
 *
 * @param value Current value.
 */
struct Total {
  value: Int
}

/**
 * A distributed counter.
 */
service Counter {

  /**
   * Increments the total and returns its current value.
   *
   * @param x Reference to total.
   * @return Current value.
   */
  def increment(x: Total&): Int = {
    if (x.value != null) x.value += 1 else x.value = 1
    x.value
  }

}